SELECT
    item_category,
    year,
    month,
    day,
    hour,
    
    -- Existing metrics
    SUM(CASE WHEN interaction_type IN ('POSITIVE_IMPLICIT','SHORT_LIVED_CLICK') THEN 1 ELSE 0 END) AS clicked,
    SUM(CASE WHEN interaction_type = 'IMPRESSION' THEN 1 ELSE 0 END) AS impressions,
    
    -- New: Transactions CTR
    CAST(SUM(CASE WHEN ui_object_detail = 'transactions' AND interaction_type IN ('POSITIVE_IMPLICIT','SHORT_LIVED_CLICK') THEN 1 ELSE 0 END) AS DOUBLE) /
    NULLIF(SUM(CASE WHEN ui_object_detail = 'transactions' AND interaction_type = 'IMPRESSION' THEN 1 ELSE 0 END),0) AS transactions_ctr,

    -- New: Reports CTR
    CAST(SUM(CASE WHEN ui_object_detail = 'reports' AND interaction_type IN ('POSITIVE_IMPLICIT','SHORT_LIVED_CLICK') THEN 1 ELSE 0 END) AS DOUBLE) /
    NULLIF(SUM(CASE WHEN ui_object_detail = 'reports' AND interaction_type = 'IMPRESSION' THEN 1 ELSE 0 END),0) AS reports_ctr,

    -- New: Contacts CTR
    CAST(SUM(CASE WHEN ui_object_detail = 'contacts' AND interaction_type IN ('POSITIVE_IMPLICIT','SHORT_LIVED_CLICK') THEN 1 ELSE 0 END) AS DOUBLE) /
    NULLIF(SUM(CASE WHEN ui_object_detail = 'contacts' AND interaction_type = 'IMPRESSION' THEN 1 ELSE 0 END),0) AS contacts_ctr,

    -- New: Ledger Accounts CTR
    CAST(SUM(CASE WHEN ui_object_detail = 'ledger_accounts' AND interaction_type IN ('POSITIVE_IMPLICIT','SHORT_LIVED_CLICK') THEN 1 ELSE 0 END) AS DOUBLE) /
    NULLIF(SUM(CASE WHEN ui_object_detail = 'ledger_accounts' AND interaction_type = 'IMPRESSION' THEN 1 ELSE 0 END),0) AS ledger_ctr

FROM `search_golden_data`
GROUP BY item_category, year, month, day, hour